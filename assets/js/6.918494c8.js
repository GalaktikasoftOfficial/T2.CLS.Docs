(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{357:function(s,t,e){s.exports=e.p+"assets/img/CH_Check.acb1eceb.png"},358:function(s,t,e){s.exports=e.p+"assets/img/CH_Check_Br.672734e2.png"},359:function(s,t,e){s.exports=e.p+"assets/img/GeneratePass.c1a5b12e.png"},421:function(s,t,e){"use strict";e.r(t);var a=e(42),r=Object(a.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",[s._v(" Установка и настройка "),a("b",[s._v("ClickHouse")])]),s._v(" "),a("p",[s._v("Для установки "),a("strong",[s._v("ClickHouse")]),s._v(" можно воспользоваться "),a("a",{attrs:{href:"https://clickhouse.tech/docs/ru/getting-started/install/",target:"_blank",rel:"noopener noreferrer"}},[s._v("инструкцией"),a("OutboundLink")],1),s._v(".")]),s._v(" "),a("h3",{attrs:{id:"пример-установки-на-виртуальнои-машине-с-ubuntu-20-04-1"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#пример-установки-на-виртуальнои-машине-с-ubuntu-20-04-1"}},[s._v("#")]),s._v(" Пример установки на виртуальной машине с "),a("strong",[s._v("Ubuntu-20.04.1")])]),s._v(" "),a("h4",{attrs:{id:"_1-работа-с-прокси"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-работа-с-прокси"}},[s._v("#")]),s._v(" 1. Работа с прокси")]),s._v(" "),a("p",[s._v("В некоторых случаях требуется работа через прокси. Адрес к прокси серверу выглядит следующим образом:")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("http://UserName:pass@SERVER:PORT\n")])])]),a("p",[a("em",[s._v("UserName")]),s._v(" и "),a("em",[s._v("pass")]),s._v(" не обязательные параметры. Далее адрес прокси будем писать следующего вида:")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("http://your_proxy_server:port\n")])])]),a("p",[s._v("Прокси прописывается в нескольких местах:")]),s._v(" "),a("ul",[a("li",[s._v("Для "),a("strong",[s._v("apt-get")]),s._v(". Как это cделать "),a("a",{attrs:{href:"https://www.serverlab.ca/tutorials/linux/administration-linux/how-to-set-the-proxy-for-apt-for-ubuntu-18-04/",target:"_blank",rel:"noopener noreferrer"}},[s._v("тут"),a("OutboundLink")],1)]),s._v(" "),a("li",[s._v("В системных переменных "),a("em",[s._v("proxy_http")]),s._v(" и "),a("em",[s._v("proxy_https")])])]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("$ export http_proxy=http://UserName:pass@SERVER:PORT\n$ export https_proxy=http://UserName:pass@SERVER:PORT\n")])])]),a("ul",[a("li",[s._v("Для отдельных команд соответствуя их синтаксису")])]),s._v(" "),a("h4",{attrs:{id:"_2-установка-clickhouse"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-установка-clickhouse"}},[s._v("#")]),s._v(" 2. Установка "),a("strong",[s._v("ClickHouse")])]),s._v(" "),a("p",[s._v("2.1. Установка пакета "),a("em",[s._v("apt-transport-https")])]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("$ sudo apt-get install apt-transport-https ca-certificates dirmngr\n")])])]),a("p",[s._v("2.2. Добавление цифровой подписи")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("$ sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv E0C56BD4\n")])])]),a("p",[s._v("Если требуется работать через прокси, то необходимо для команды указывать параметры")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v('$ sudo apt-key adv --keyserver-options http-proxy="http://your_proxy_server:port"  --keyserver hkp://keyserver.ubuntu.com:80 --recv E0C56BD4\n')])])]),a("p",[s._v("2.3. Регистрация источников пакетов "),a("strong",[s._v("Clickhouse")])]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v('$ echo "deb https://repo.clickhouse.tech/deb/stable/ main/" | sudo tee /etc/apt/sources.list.d/clickhouse.list\n$ sudo apt-get update\n')])])]),a("p",[s._v("2.4. Установка  сервера ClickHouse")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("$ sudo apt-get install clickhouse-server\n")])])]),a("p",[s._v("2.5. Установка  клиента ClickHouse")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("$ sudo apt-get install clickhouse-client\n")])])]),a("p",[s._v("2.6. Запуск сервера")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("$ sudo service clickhouse-server start\n")])])]),a("h4",{attrs:{id:"_3-управление-службои-clickhouse"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-управление-службои-clickhouse"}},[s._v("#")]),s._v(" 3. Управление службой "),a("strong",[s._v("ClickHouse")])]),s._v(" "),a("p",[s._v("3.1. Проверка работы сервиса:")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("$ systemctl status clickhouse-server\n")])])]),a("p",[s._v("3.2. Запуск сервиса:")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("$ systemctl start clickhouse-server\n")])])]),a("p",[s._v("3.2. Остановка сервиса:")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("$ systemctl stop clickhouse-server\n")])])]),a("h4",{attrs:{id:"_4-проверка-работоспособности"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-проверка-работоспособности"}},[s._v("#")]),s._v(" 4. Проверка работоспособности")]),s._v(" "),a("p",[s._v("4.1. Из "),a("strong",[s._v("терминала")]),s._v(":")]),s._v(" "),a("p",[s._v("Последовательно выполнить команды:")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("$ clickhouse-client\n$ select 1\n")])])]),a("p",[s._v("Результатом будет следующее:")]),s._v(" "),a("p",[a("img",{attrs:{src:e(357),alt:"img"}})]),s._v(" "),a("p",[s._v("4.2. Из "),a("strong",[s._v("браузера")]),s._v(" (или из терминала используя "),a("strong",[s._v("curl")]),s._v(")")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("$ curl http://localhost:8123\n")])])]),a("p",[s._v("или")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("$ curl http://localhost:8123/?query=Select%201\n")])])]),a("p",[s._v("Результатом будет следующее:")]),s._v(" "),a("p",[a("img",{attrs:{src:e(358),alt:"img"}})]),s._v(" "),a("h4",{attrs:{id:"_5-настроика-пользователя-для-clickhouse"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-настроика-пользователя-для-clickhouse"}},[s._v("#")]),s._v(" 5. Настройка пользователя для ClickHouse")]),s._v(" "),a("p",[s._v("По умолчанию в ClickHouse используется пользователь "),a("strong",[s._v("default")]),s._v(" без пароля.\nДля установки пароля:")]),s._v(" "),a("p",[s._v("5.1. Необходимо выполнить в терминале исполнить:")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("$ PASSWORD='MyPassword'; echo \"$PASSWORD\"; echo -n \"$PASSWORD\" | sha256sum | tr -d '-'\n")])])]),a("p",[s._v("Результатом будет 2 строки пароля в открытом и зашифрованном виде.")]),s._v(" "),a("p",[a("img",{attrs:{src:e(359),alt:"img"}})]),s._v(" "),a("p",[s._v("5.2. Открываем файл /etc/clickhouse-server/users.xml.")]),s._v(" "),a("p",[s._v("5.3. Находим секции "),a("em",[s._v("yandex->users->default")]),s._v(" и добавляем тег "),a("em",[s._v("password_sha256_hex")])]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("<yandex>\n...\n\t<users>\n\t...\n\t\t<default>\n\t\t\t<password_sha256_hex>dc1e7c03e162397b355b6f1c895dfdf3790d98c10b920c55e91272b8eecada2a</password_sha256_hex>\n\t\t\t...\n\t\t</default>\n\t...\n\t</users>\n...\n</yandex>\n")])])]),a("p",[s._v("5.4. Сохраняем файл")]),s._v(" "),a("p",[s._v("5.6. Перезапускаем сервис ClickHouse")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("$ systemctl restart clickhouse-server\n")])])]),a("p",[s._v("5.7. Проверяем внесённые изменения")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("$  curl http://default:MyPassword@localhost:8123/?query=Select%201\n")])])]),a("h4",{attrs:{id:"_6-другие-настроики-clickhouse"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-другие-настроики-clickhouse"}},[s._v("#")]),s._v(" 6. Другие настройки ClickHouse")]),s._v(" "),a("p",[s._v("Смотреть официальную документацию на "),a("a",{attrs:{href:"https://clickhouse.tech/docs/",target:"_blank",rel:"noopener noreferrer"}},[s._v("портале"),a("OutboundLink")],1)])])}),[],!1,null,null,null);t.default=r.exports}}]);